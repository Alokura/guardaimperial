<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Mapa Interativo</title>
  <style>
    :root{ --ui-bg:#0b0f14; --ui-fg:#e8ecf1; --ui-muted:#8fb38a; }
    html,body{height:100%; margin:0}
    body{background:#0b0f14; color:var(--ui-fg); font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Inter,sans-serif; display:grid; grid-template-rows:auto 1fr}

    header{padding:12px 20px}
    .brand{
      font-weight:800; letter-spacing:.3px;
      position:relative; display:inline-block;
    }
    .brand::after{
      content:""; position:absolute; left:0; bottom:-6px; height:3px; width:140px;
      border-radius:3px;
      background:linear-gradient(90deg,#67ff9c,transparent);
      opacity:.8;
    }

    .wrap{display:grid; grid-template-columns:300px 1fr; gap:14px; padding:0 20px 20px; overflow:hidden}
    @media(max-width:980px){.wrap{grid-template-columns:1fr}}

    .panel{background:#121821; border:1px solid #1b2633; border-radius:16px; box-shadow:0 10px 30px rgba(0,0,0,.35)}
    .controls{padding:14px; position:sticky; top:10px; height:fit-content}
    .controls h3{margin:4px 0 12px; font-size:15px; color:#cfe0f3; font-weight:700; letter-spacing:.2px}

    .row{
      display:flex; align-items:center; justify-content:space-between;
      gap:8px; padding:10px 4px;
    }
    .row + .row{ border-top:1px solid rgba(255,255,255,.06) }

    .row label{ display:flex; align-items:center; gap:10px; font-size:14px; line-height:1 }

    .name{
      display:inline-flex; align-items:center; gap:8px;
      padding:6px 10px; border-radius:10px;
      background:rgba(255,255,255,.04);
      border:1px solid rgba(255,255,255,.08);
      color:#e7eef7; font-weight:600;
      transition:background .15s ease, border-color .15s ease;
    }
    .dot{
      width:8px; height:8px; border-radius:999px;
      box-shadow:0 0 0 2px rgba(255,255,255,.06) inset;
    }
    .name:hover{ background:rgba(255,255,255,.06); border-color:rgba(255,255,255,.14) }

    .amarelo .dot{ background:#ffd54a }
    .azul    .dot{ background:#6ecbff }
    .ciano   .dot{ background:#55f0ff }
    .marrom  .dot{ background:#d3a06a }
    .rosa    .dot{ background:#ff8bd1 }
    .verde   .dot{ background:#6bff86 }
    .vermelho .dot{ background:#ff6b6b }

    .skull{
      width:28px; height:28px; display:flex; align-items:center; justify-content:center;
      border-radius:8px; border:1px solid #2a3a4a; background:#0e1621; color:#ffd1d1;
      cursor:pointer; font-size:16px; line-height:1;
    }
    .skull:active{transform:translateY(1px)}

    .map-shell{position:relative; display:grid; place-items:center; padding:12px; height:100%}
    .map-stage{position:relative; width:100%; height:100%; max-width:100%; max-height:100%; background:#0a0f15; border:1px solid #18212c; border-radius:18px; overflow:hidden}
.map-stage::before{
  content:"";
  position:absolute;
  inset:0;
  pointer-events:none;
  /* se existir um arquivo, ele entra como base; se n√£o existir, os gradientes j√° resolvem */
  background:
    url("image/ui/pergaminho.jpg") center/cover no-repeat,
    repeating-linear-gradient(0deg, rgba(255,240,200,.04) 0 2px, transparent 2px 6px),
    repeating-linear-gradient(90deg, rgba(255,245,210,.03) 0 3px, transparent 3px 8px);
  mix-blend-mode:overlay;
  opacity:.35;          /* for√ßa da textura, ajuste entre .2 e .5 */
}

.map-stage::after{
  content:"";
  position:absolute;
  inset:0;
  pointer-events:none;
  /* padr√£o de runas leve em SVG repetido */
  background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><g fill="none" stroke="%23bfa76a" stroke-width="1" opacity=".22"><path d="M20 30l10 10l10 -10l10 10"/><circle cx="80" cy="40" r="12"/><path d="M120 30l0 20m-10 -10l20 0"/><path d="M40 110l10 -16l10 16"/><path d="M90 110l10 -10l10 10"/><circle cx="130" cy="120" r="8"/></g></svg>');
  background-size:160px 160px;
  background-repeat:repeat;
  opacity:.15;          /* intensidade das runas, ajuste entre .08 e .25 */
  filter:blur(.2px);    /* tira o ‚Äúvetor puro‚Äù do SVG */
}


    .viewport{position:absolute; inset:0; transform-origin:0 0; cursor:grab; touch-action:none; user-select:none}
    .viewport.dragging{ cursor:grabbing }
    .stack, .map-stage{ user-select:none }
    .layer{position:absolute; inset:0; width:100%; height:100%; object-fit:contain; pointer-events:none; user-select:none; -webkit-user-drag:none}

    .zoomBox{position:absolute; inset:0; display:none; align-items:center; justify-content:center; background:#0a0f15; z-index:10}
    .zoomBox.on{display:flex}
    .zoomBox img{max-width:100%; max-height:100%; border-radius:12px; box-shadow:0 8px 30px rgba(0,0,0,.6)}
/* fundo do zoom com gradiente animado */
.zoomBox{
  position:absolute;
  inset:0;
  display:none;
  align-items:center;
  justify-content:center;
  background:#0a0f15;
  z-index:10;
  overflow:hidden;           /* garante efeitos dentro da box */
}
.zoomBox.on{display:flex}

/* imagem fica por cima dos efeitos */
.zoomBox img{
  max-width:100%;
  max-height:100%;
  border-radius:12px;
  box-shadow:0 8px 30px rgba(0,0,0,.6);
  position:relative;
  z-index:1;
}

/* glow m√°gico animado atr√°s */
.zoomBox::before{
  content:"";
  position:absolute;
  inset:-10%;
  pointer-events:none;
  z-index:0;
  background:
    radial-gradient(800px 400px at 20% 20%, rgba(110,180,255,.18), transparent 70%),
    radial-gradient(700px 350px at 80% 70%, rgba(120,255,200,.12), transparent 70%),
    radial-gradient(900px 500px at 50% 10%, rgba(160,120,255,.10), transparent 70%),
    #0a0f15;
  filter:saturate(140%) brightness(110%);
  animation:zoomGlow 14s ease-in-out infinite alternate;
}
@keyframes zoomGlow{
  0%   { background-position:   0    0,   0    0,   0    0, 0 0; }
  50%  { background-position: 160px -80px, -120px 80px, 80px 40px, 0 0; }
  100% { background-position:   0    0,   0    0,   0    0, 0 0; }
}

/* part√≠culas sutis tipo estrelas/fuma√ßa */
.zoomBox::after{
  content:"";
  position:absolute;
  inset:-10%;
  pointer-events:none;
  z-index:0;
  opacity:.18;                       /* for√ßa das part√≠culas */
  background-image:
    url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160"><g opacity=".9"><circle cx="12" cy="20" r="1.2" fill="white"/><circle cx="80" cy="40" r="1" fill="white"/><circle cx="140" cy="30" r="1.4" fill="white"/><circle cx="40" cy="120" r="1.1" fill="white"/><circle cx="100" cy="100" r="1.3" fill="white"/><circle cx="150" cy="140" r="1" fill="white"/><circle cx="20" cy="80" r="0.9" fill="white"/></g></svg>'),
    url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="120" height="120"><g opacity=".7"><circle cx="10" cy="10" r="0.9" fill="white"/><circle cx="30" cy="90" r="0.8" fill="white"/><circle cx="70" cy="30" r="1.1" fill="white"/><circle cx="110" cy="60" r="0.9" fill="white"/><circle cx="60" cy="110" r="1" fill="white"/></g></svg>');
  background-repeat:repeat, repeat;
  background-size:320px 320px, 220px 220px;
  animation:starsMove 90s linear infinite;
}
@keyframes starsMove{
  to{ background-position: 320px 180px, -220px 120px; }
}

/* garante o bot√£o por cima */
.zoomActions{
  position:absolute;
  top:16px;
  right:16px;
  display:flex;
  gap:10px;
  z-index:20;
}
    /* bot√£o de voltar fixo no canto */
    .zoomActions{
      position:absolute;
      top:16px;
      right:16px;
      display:flex;
      gap:10px;
      z-index:20;
    }

    @keyframes pulse-glow {
      0%,100%{ box-shadow:0 0 10px rgba(62,255,72,.4), inset 0 0 4px rgba(62,255,62,.25) }
      50%{ box-shadow:0 0 16px rgba(62,255,72,.6), inset 0 0 6px rgba(62,255,117,.4) }
    }
    .btn{
      animation:pulse-glow 2.2s infinite;
      border:1px solid #2d8234; background:linear-gradient(145deg,#066d0a,#0c0614);
      color:#e0f7e6; padding:8px 16px; border-radius:10px; cursor:pointer;
      font-size:15px; font-weight:600; letter-spacing:.4px;
      box-shadow:0 0 8px rgba(62,255,75,.25), inset 0 0 6px rgba(62,255,75,.2);
      transition:transform .15s ease, box-shadow .15s ease;
    }
    .btn:hover{ transform:scale(1.05); box-shadow:0 0 14px rgba(62,255,65,.45), inset 0 0 8px rgba(65,255,62,.35) }
    .btn:active{ transform:scale(.97) }
  </style>
</head>
<body>
  <header><div class="brand">Mapa Interativo</div></header>

  <div class="wrap">
    <aside class="panel controls">
      <h3>Camadas</h3>

      <div class="row">
        <label><input data-id="amarelo" type="checkbox" checked> <span class="name amarelo"><i class="dot"></i>Amarelo</span></label>
        <button class="skull" data-zoom="amarelo">üíÄ</button>
      </div>
      <div class="row">
        <label><input data-id="azul" type="checkbox" checked> <span class="name azul"><i class="dot"></i>Azul</span></label>
        <button class="skull" data-zoom="azul">üíÄ</button>
      </div>
      <div class="row">
        <label><input data-id="ciano" type="checkbox" checked> <span class="name ciano"><i class="dot"></i>Ciano</span></label>
        <button class="skull" data-zoom="ciano">üíÄ</button>
      </div>
      <div class="row">
        <label><input data-id="marrom" type="checkbox" checked> <span class="name marrom"><i class="dot"></i>Marrom</span></label>
        <button class="skull" data-zoom="marrom">üíÄ</button>
      </div>
      <div class="row">
        <label><input data-id="rosa" type="checkbox" checked> <span class="name rosa"><i class="dot"></i>Rosa</span></label>
        <button class="skull" data-zoom="rosa">üíÄ</button>
      </div>
      <div class="row">
        <label><input data-id="verde" type="checkbox" checked> <span class="name verde"><i class="dot"></i>Verde</span></label>
        <button class="skull" data-zoom="verde">üíÄ</button>
      </div>
      <div class="row">
        <label><input data-id="vermelho" type="checkbox" checked> <span class="name vermelho"><i class="dot"></i>Vermelho</span></label>
        <button class="skull" data-zoom="vermelho">üíÄ</button>
      </div>
    </aside>

    <main class="panel map-shell">
      <div class="map-stage" id="stage">
        <div class="viewport" id="viewport">
          <div class="stack" id="stack">
            <img class="layer" data-region="amarelo" src="image/mapa/amarelomap.png" alt="Amarelo">
            <img class="layer" data-region="azul" src="image/mapa/azulmap.png" alt="Azul">
            <img class="layer" data-region="ciano" src="image/mapa/cianomap.png" alt="Ciano">
            <img class="layer" data-region="marrom" src="image/mapa/marrommap.png" alt="Marrom">
            <img class="layer" data-region="rosa" src="image/mapa/rosamap.png" alt="Rosa">
            <img class="layer" data-region="verde" src="image/mapa/verdemap.png" alt="Verde">
            <img class="layer" data-region="vermelho" src="image/mapa/vermelhomap.png" alt="Vermelho">
          </div>
        </div>
        <div class="zoomBox" id="zoomBox">
          <div class="zoomActions"><button class="btn" id="backBtn">Voltar</button></div>
          <img id="zoomImg" alt="Zoom">
        </div>
      </div>
    </main>
  </div>

  <script>
    document.querySelectorAll('.controls input[type=checkbox]').forEach(cb=>{
      cb.addEventListener('change', ()=>{
        const id = cb.dataset.id;
        const el = document.querySelector(`.layer[data-region="${id}"]`);
        if(!el) return;
        el.style.display = cb.checked ? 'block' : 'none';
      });
    });

    const zoomImages = { amarelo:'Amarelo.png', azul:'Azul.png', ciano:'Ciano.png', marrom:'Marrom.png', rosa:'Rosa.png', verde:'Verde.png', vermelho:'Vermelho.png' };
    const zoomBox = document.getElementById('zoomBox');
    const zoomImg = document.getElementById('zoomImg');
    const backBtn = document.getElementById('backBtn');
    const viewport = document.getElementById('viewport');
    const stage = document.getElementById('stage');

    function openZoom(id){
      const f = zoomImages[id]; if(!f) return;
      zoomImg.src = 'image/zoom/' + f;
      viewport.style.display = 'none';
      zoomBox.classList.add('on');
    }
    function closeZoom(){ zoomBox.classList.remove('on'); viewport.style.display = 'block'; }
    backBtn.addEventListener('click', closeZoom);

    document.querySelectorAll('.skull').forEach(btn=> btn.addEventListener('click', ()=> openZoom(btn.dataset.zoom)));

    (function enableZoomPan(){
      let scale = 1, x = 0, y = 0;
      const minScale = scale, maxScale = 16, ZOOM_SENS = 1.12;
      let dragging = false, lx = 0, ly = 0;

      function clamp(){
        const bw = stage.clientWidth, bh = stage.clientHeight;
        const cw = bw * scale, ch = bh * scale;
        const minX = Math.min(0, bw - cw), minY = Math.min(0, bh - ch);
        if (x < minX) x = minX; if (x > 0) x = 0;
        if (y < minY) y = minY; if (y > 0) y = 0;
      }
      function apply(){ clamp(); viewport.style.transform = `translate3d(${x}px,${y}px,0) scale(${scale})`; }

      viewport.addEventListener('wheel', e=>{
        e.preventDefault();
        const rect = stage.getBoundingClientRect();
        const mx = e.clientX - rect.left, my = e.clientY - rect.top;
        const deltaPx = e.deltaMode === 1 ? e.deltaY * 16 : e.deltaY;
        const prev = scale;
        const ns = Math.min(maxScale, Math.max(minScale, prev * Math.pow(ZOOM_SENS, -deltaPx / 120)));
        if (ns === prev) return;
        const wx = (mx - x) / prev, wy = (my - y) / prev;
        scale = ns; x = mx - wx * scale; y = my - wy * scale;
        if (scale === minScale){ x = 0; y = 0; }
        apply();
      }, {passive:false});

      viewport.addEventListener('pointerdown', e=>{
        if(e.button !== 0) return;
        dragging = true; viewport.classList.add('dragging');
        lx = e.clientX - x; ly = e.clientY - y;
      });
      viewport.addEventListener('pointermove', e=>{
        if(!dragging) return;
        if((e.buttons & 1) === 0){ dragging = false; viewport.classList.remove('dragging'); return; }
        x = e.clientX - lx; y = e.clientY - ly; apply();
      });
      function endDrag(){ dragging = false; viewport.classList.remove('dragging'); }
      viewport.addEventListener('pointerup', endDrag);
      viewport.addEventListener('pointerleave', endDrag);
      viewport.addEventListener('pointercancel', endDrag);
      window.addEventListener('resize', ()=>{ if(scale===minScale){ x=0; y=0; apply(); }});
    })();
  </script>
</body>
</html>
